---
layout: default
title: Besuchte Orte
subtitle: Alle Länder und Städte, die wir bereisten
permalink: /places/
---

<article class="places-page">
  {% include page-header.html title=page.title subtitle=page.subtitle %}

  {% assign day_pages = site.pages | where: 'layout', 'day' %}
  {% assign countries_with_entries = '' | split: '' %}
  {% assign country_sections = '' %}

  {% for country in site.data.countries %}
    {% assign country_key = country[0] %}
    {% assign country_data = country[1] %}
    {% assign country_day_entries = day_pages | where: 'country', country_key %}
    {% if country_day_entries.size > 0 %}
      {% assign city_markup = '' %}
      {% assign city_count = 0 %}
      {% for city in country_data.cities %}
        {% assign city_key = city[0] %}
        {% assign city_data = city[1] %}
        {% assign city_day_pages = '' | split: '' %}
        {% for day_page in country_day_entries %}
          {% assign city_list = day_page.city | array %}
          {% if city_list contains city_key %}
            {% assign city_day_pages = city_day_pages | push: day_page %}
          {% endif %}
        {% endfor %}
        {% if city_day_pages.size > 0 %}
          {% assign city_page = site.pages | where: 'layout', 'city' | where: 'country', country_key | where: 'city', city_key | first %}
          {% capture city_markup %}
            {{ city_markup }}
            {% include card.html type='city' item=city_page country=country_key city=city_key day_pages=city_day_pages %}
          {% endcapture %}
          {% assign city_count = city_count | plus: 1 %}
        {% endif %}
      {% endfor %}
      {% if city_count > 0 %}
        {% assign country_page = site.pages | where: 'layout', 'country' | where: 'country', country_key | first %}
        {% capture country_sections %}
          {{ country_sections }}
          <section class="places-country" data-filter-section>
            <header class="places-country__header">
              <h2>{{ country_data.flag }} {{ country_data.name }}</h2>
              <p>{{ city_count }} Städte · {{ country_day_entries.size }} Tage</p>
            </header>
            <div class="places-country__summary">
                <a class="button button--ghost" href="{{ '/places/' | append: country_key | append: '/' | relative_url }}">Land anzeigen</a>
            </div>
            <div class="grid grid--cities" data-filter-collection>
              {{ city_markup | strip }}
            </div>
          </section>
        {% endcapture %}
        {% assign countries_with_entries = countries_with_entries | push: country_key %}
      {% endif %}
    {% endif %}
  {% endfor %}

  {% if countries_with_entries.size > 0 %}
    <div class="filter-bar" data-filter-target="#places-collection" data-filter-collapse=".places-country">
      <div class="filter-bar__group" data-filter-group="journey">
        <label class="filter-bar__label" for="places-filter-journey">Reise</label>
        <select id="places-filter-journey" class="filter-bar__select" data-filter="journey">
          <option value="">Alle Reisen</option>
        </select>
      </div>
      <div class="filter-bar__group" data-filter-group="country">
        <label class="filter-bar__label" for="places-filter-country">Land</label>
        <select id="places-filter-country" class="filter-bar__select" data-filter="country">
          <option value="">Alle Länder</option>
        </select>
      </div>
      <div class="filter-bar__group" data-filter-group="city">
        <label class="filter-bar__label" for="places-filter-city">Stadt</label>
        <select id="places-filter-city" class="filter-bar__select" data-filter="city">
          <option value="">Alle Städte</option>
        </select>
      </div>
      <button class="filter-bar__reset" type="button" data-filter-reset hidden>Filter zurücksetzen</button>
    </div>

    <div id="places-collection">
      <p class="filter-empty" data-filter-empty hidden aria-live="polite">Keine Orte für die aktuelle Auswahl.</p>
      {{ country_sections | strip }}
    </div>
  {% else %}
    <p>Es wurden noch keine Orte besucht. Sobald Tagebucheinträge existieren, erscheinen die Orte an dieser Stelle.</p>
  {% endif %}
</article>
