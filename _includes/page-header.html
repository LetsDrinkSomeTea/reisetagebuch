{% comment %}
Reusable Page Header Component
Parameters:
- title: page title (defaults to page.title)
- subtitle: optional subtitle
- show_meta: boolean - show entry meta for day pages (default: false)

Usage:
{% include page-header.html %}
{% include page-header.html title="Custom Title" subtitle="Subtitle" %}
{% include page-header.html show_meta=true %}
{% endcomment %}

<header class="{% if page.layout == 'day' %}entry-header{% else %}page-header{% endif %}">
  {% include breadcrumb.html city=include.city %}
  
  {% assign header_title = include.title | default: page.title %}
  
  {% if page.layout == "day" %}
    <h1>{{ header_title }}</h1>
    
    {% if include.show_meta != false %}
      {% comment %} Auto-detect country from first city if not set {% endcomment %}
      {% assign page_country = page.country %}
      {% unless page_country %}
        {% assign first_city = page.city | array | first %}
        {% if first_city %}
          {% assign first_city_data = site.data.cities[first_city] %}
          {% if first_city_data %}
            {% assign page_country = first_city_data.country %}
          {% endif %}
        {% endif %}
      {% endunless %}
      {% assign country_data = site.data.countries[page_country] %}
      {% assign city_badges = '' | split: '' %}
      {% if page.city %}
        {% for city_key in page.city %}
          {% unless city_badges contains city_key %}
            {% assign city_badges = city_badges | push: city_key %}
          {% endunless %}
        {% endfor %}
      {% elsif include.city %}
        {% assign city_badges = city_badges | push: include.city %}
      {% endif %}
      
      <div class="entry-meta">
        <div class="badge-container">
          <span class="badge badge--secondary">{{ page.date | date: '%d. %B %Y' }}</span>
          <span class="badge badge--primary">Tag {{ page.day }}</span>
          {% for city_key in city_badges %}
            {% assign city_data = site.data.cities[city_key] %}
            <span class="badge badge--primary">{% if city_data and city_data.emoji %}{{ city_data.emoji }} {% endif %}{{ city_data.name | default: city_key }}</span>
          {% endfor %}
          {% if page.weather %}
            <span class="badge badge--weather">{{ page.weather }}</span>
          {% endif %}
        </div>
      </div>
    {% endif %}
    
  {% elsif page.layout == "city" %}
    {% assign city_data = site.data.cities[page.city] %}
    {% assign page_country = page.country | default: city_data.country %}
    {% assign country_data = site.data.countries[page_country] %}
    <h1>{{ city_data.emoji }} {{ city_data.name }}{% if header_title %}<br>{{ header_title }}{% endif %}</h1>
    
  {% elsif page.layout == "country" %}
    {% assign country_data = site.data.countries[page.country] %}
    <h1>{{ country_data.flag }} {{ country_data.name }}{% if header_title %} - {{ header_title }}{% endif %}</h1>
    
  {% elsif page.layout == "gallery" %}
    <h1>ğŸ“¸ {{ header_title }}</h1>
    
  {% else %}
    <h1>{{ header_title }}</h1>
  {% endif %}
  
  {% if include.subtitle %}
    <small>{{ include.subtitle }}</small>
  {% endif %}
</header>
