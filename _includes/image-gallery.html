{% comment %}
City Gallery - Displays main images from day directories with day information
Looks for tag-X/main.jpg structure
{% endcomment %}
{% assign images_found = false %}
{% assign day_directories = "" | split: "" %}

{% comment %} Find all directories named tag-X that contain main.jpg {% endcomment %}
{% for file in site.static_files %}
    {% if file.path contains include.folder %}
        {% if file.name == "main.jpg" or file.name == "main.JPG" or file.name == "main.jpeg" or file.name == "main.JPEG" %}
            {% assign path_parts = file.path | split: "/" %}
            {% assign directory_name = path_parts[-2] %}
            {% if directory_name contains "tag-" %}
                {% assign images_found = true %}
                {% assign day_directories = day_directories | push: file %}
            {% endif %}
        {% endif %}
    {% endif %}
{% endfor %}

{% if images_found %}
<section class="image-gallery-section">
    <h2>ðŸ“¸ Bilder</h2>
    <div class="image-gallery">
        {% assign sorted_dirs = day_directories | sort: "path" %}
        {% for file in sorted_dirs %}
            {% assign path_parts = file.path | split: "/" %}
            {% assign directory_name = path_parts[-2] %}
            
            {% comment %} Extract day number from directory name (e.g., "tag-1" -> "1") {% endcomment %}
            {% assign day_number = directory_name | remove: "tag-" %}
            
            <div class="gallery-card">
                <a href="{{ file.path | relative_url }}" class="gallery-link" 
                   title="Tag {{ day_number }}"
                   data-modal-title="Tag {{ day_number }}, {{ site.data.countries[page.country].cities[page.city].name }}, {{ site.data.countries[page.country].name }}">
                    <div class="gallery-image-container">
                        <img src="{{ file.path | relative_url }}" alt="Bild von Tag {{ day_number }}" />
                        <div class="gallery-overlay">
                            <span class="gallery-day-badge">Tag {{ day_number }}</span>
                        </div>
                    </div>
                </a>
            </div>
        {% endfor %}
    </div>
</section>
{% endif %}
