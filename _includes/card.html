{% comment %}
Unified Card Component
Parameters:
- type: "city" or "day" or "country" - determines card structure
- item: the page/data object to display
- country_data: country data (for city/day cards)
- city_data: city data (for day cards only)
- day_pages: array of day pages (for city cards)

Usage:
{% include card.html type="city" item=city_page country_data=country_data city_data=city_data day_pages=day_pages %}
{% include card.html type="day" item=day_page country_data=country_data city_data=city_data %}
{% endcomment %}

<article class="card{% if include.type %} card--{{ include.type }}{% endif %}">
  <header>
    {% case include.type %}
      {% when "city" %}
        <h3>
          <a href="{{ include.item.url | relative_url }}">
            {{ include.city_data.emoji }} {{ include.city_data.name }}
          </a>
        </h3>
        <span class="day-count">{{ include.day_pages.size }} {% if include.day_pages.size == 1 %}Tag{% else %}Tage{% endif %}</span>
        
      {% when "day" %}
        <h3><a href="{{ include.item.url | relative_url }}">Tag {{ include.item.day }}</a></h3>
        <time datetime="{{ include.item.date | date: '%Y-%m-%d' }}">
          {{ include.item.date | date: '%d.%m.%Y' }}
        </time>
        
      {% else %}
        <h3>
          {% if include.item.url %}
            <a href="{{ include.item.url | relative_url }}">{{ include.item.title }}</a>
          {% else %}
            {{ include.item.title }}
          {% endif %}
        </h3>
    {% endcase %}
  </header>

  <div class="card-content">
    {% case include.type %}
      {% when "city" %}
        {% if include.item.excerpt %}
          <p>{{ include.item.excerpt | strip_html | truncate: 100 }}</p>
        {% endif %}
        
        <div class="latest-entries">
          <h4>Neueste Einträge:</h4>
          <ul>
            {% assign recent_days = include.day_pages | sort: "date" | reverse %}
            {% for day_page in recent_days limit: 3 %}
              <li>
                <a href="{{ day_page.url | relative_url }}">
                  Tag {{ day_page.day }} - {{ day_page.date | date: '%d.%m.' }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </div>
        
      {% when "day" %}
        <h4>{{ include.item.title }}</h4>
        
        {% if include.item.excerpt %}
          <p>{{ include.item.excerpt | strip_html | truncate: 120 }}</p>
        {% endif %}
        
        {% if include.item.weather %}
          <span class="badge badge--weather">{{ include.item.weather }}</span>
        {% endif %}
        
      {% else %}
        {% if include.item.excerpt %}
          <p>{{ include.item.excerpt | strip_html | truncate: 120 }}</p>
        {% endif %}
    {% endcase %}
  </div>

  <footer>
    {% case include.type %}
      {% when "city" %}
        <a href="{{ include.item.url | relative_url }}" class="view-city">Stadt ansehen →</a>
      {% when "day" %}
        <a href="{{ include.item.url | relative_url }}" class="read-more">Weiterlesen →</a>
      {% else %}
        {% if include.item.url %}
          <a href="{{ include.item.url | relative_url }}">Ansehen →</a>
        {% endif %}
    {% endcase %}
  </footer>
</article>